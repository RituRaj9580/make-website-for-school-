<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A.D.M Public School - Empowering minds and shaping the future in Garhwa.">
    <title>A.D.M Public School | Admissions</title>
    <style>
        /* --- Core Theme Variables --- */
        :root {
            --bg-dark: #0a0a0a;
            --bg-section: #111111;
            --text-main: #d1d5db;
            --text-heading: #ffffff;
            --accent-orange: #ff9900;
            --accent-orange-hover: #e68a00;
            --footer-blue: #003a8c;
            --border-color: #333333;
            
            /* Admission Portal Light Theme */
            --bg-light: #f8fafc;
            --text-dark: #1e293b;
            --primary-blue: #3b82f6;
            --primary-blue-dark: #2563eb;
            --success-color: #10b981;
            --error-color: #ef4444;
            --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* --- Reset & Base Styles --- */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Segoe UI', system-ui, -apple-system, sans-serif; background-color: var(--bg-dark); color: var(--text-main); overflow-x: hidden; scroll-behavior: smooth; line-height: 1.6; }
        *:focus-visible { outline: 2px solid var(--accent-orange); outline-offset: 4px; }

        /* --- Animations --- */
        @keyframes fadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideInRight { from { transform: translateX(100%); opacity: 0;} to { transform: translateX(0); opacity: 1;} }

        /* --- Navigation Menu --- */
        header { background-color: rgba(0, 0, 0, 0.95); backdrop-filter: blur(10px); position: sticky; top: 0; z-index: 1000; border-bottom: 1px solid var(--border-color); }
        nav { display: flex; justify-content: space-between; align-items: center; padding: 15px 40px; max-width: 1400px; margin: 0 auto; }
        .nav-brand { display: flex; align-items: center; gap: 10px; cursor: pointer; }
        .logo-img { width: 32px; height: 32px; background: #fff; border-radius: 50%; }
        .logo-text { color: #fff; font-size: 1.1rem; font-weight: 700; letter-spacing: 1px; }
        .nav-links { display: flex; gap: 25px; list-style: none; }
        .nav-links a { color: #a3a3a3; text-decoration: none; font-size: 0.9rem; font-weight: 600; transition: var(--transition-smooth); }
        .nav-links a:hover, .nav-links a.active { color: #ffffff; }
        
        .nav-actions { display: flex; align-items: center; gap: 20px; }
        .contact-phone { display: flex; align-items: center; gap: 8px; color: #fff; font-size: 0.9rem; font-weight: 700;}
        .phone-icon { color: var(--primary-blue); font-size: 1.1rem;}
        
        .btn { border: none; border-radius: 30px; padding: 10px 24px; font-size: 0.9rem; font-weight: 700; cursor: pointer; transition: var(--transition-smooth); display: inline-flex; align-items: center; justify-content: center; }
        .btn-primary { background-color: var(--accent-orange); color: #000; }
        .btn-primary:hover { background-color: var(--accent-orange-hover); color: #fff; transform: translateY(-2px); }
        .mobile-toggle { display: none; background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer; }

        /* --- Layout & Sections --- */
        main { min-height: calc(100vh - 80px); }
        .page-section { display: none; width: 100%; animation: fadeUp 0.5s ease-out forwards; }
        .page-section.active { display: block; }
        .section-container { max-width: 1100px; margin: 0 auto; padding: 80px 20px; }
        .section-title { color: var(--text-heading); font-size: 2rem; text-align: center; margin-bottom: 50px; font-weight: 800; }

        /* --- Home Page Components --- */
        .hero-banner { height: 60vh; min-height: 400px; background: linear-gradient(rgba(0,0,0,0.2), rgba(0,0,0,0.6)), url('https://images.unsplash.com/photo-1577896851231-70ef18881754?auto=format&fit=crop&q=80&w=2070') center/cover no-repeat; display: flex; align-items: center; justify-content: center; }
        .about-grid { display: grid; gap: 60px; }
        .about-row { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; align-items: center; }
        .about-text h3 { color: var(--text-heading); font-size: 1.5rem; margin-bottom: 15px; }
        .about-text p { color: #9ca3af; }
        .about-image { height: 350px; background: url('https://images.unsplash.com/photo-1507842217343-583bb7270b66?auto=format&fit=crop&q=80&w=1000') center/cover; border-radius: 8px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }

        .amenities-grid { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; max-width: 900px; margin: 0 auto; }
        .amenity-pill { border: 1px solid var(--border-color); border-radius: 30px; padding: 10px 25px; display: flex; align-items: center; gap: 12px; color: var(--text-main); font-size: 0.95rem; background: rgba(255,255,255,0.02); transition: var(--transition-smooth); }
        .amenity-pill:hover { border-color: var(--accent-orange); background: rgba(255, 153, 0, 0.05); transform: translateY(-3px); }
        .amenity-pill span { background: #262626; border-radius: 50%; width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; font-size: 0.8rem;}

        .contact-form { max-width: 600px; margin: 0 auto; display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
        .full-width { grid-column: 1 / -1; }
        .minimal-input { width: 100%; padding: 12px 0; background: transparent; border: none; border-bottom: 1px solid var(--border-color); color: #fff; font-size: 1rem; transition: var(--transition-smooth); }
        .minimal-input:focus { outline: none; border-bottom-color: var(--accent-orange); }

        /* Toast Notifications */
        #toast-container { position: fixed; bottom: 30px; right: 30px; z-index: 9999; display: flex; flex-direction: column; gap: 10px; }
        .toast { background: #1e293b; color: #fff; padding: 15px 25px; border-radius: 8px; box-shadow: 0 10px 25px rgba(0,0,0,0.5); display: flex; align-items: center; gap: 15px; animation: slideInRight 0.3s forwards; font-weight: 500;}
        .toast.success { border-left: 4px solid var(--success-color); }
        .toast.error { border-left: 4px solid var(--error-color); }
        @keyframes fadeOut { to { opacity: 0; transform: translateX(100%); } }

        /* --- ADMISSION PORTAL WIZARD --- */
        #admission { background-color: var(--bg-light); color: var(--text-dark); padding-bottom: 80px;}
        .form-box { max-width: 650px; margin: 40px auto; background: #ffffff; padding: 40px; border-radius: 16px; box-shadow: 0 15px 35px rgba(0,0,0,0.05); border: 1px solid #e2e8f0; }
        
        .wizard-progress { display: flex; justify-content: space-between; position: relative; margin-bottom: 40px; padding: 0 20px;}
        .wizard-progress::before { content: ''; position: absolute; top: 50%; left: 30px; right: 30px; height: 3px; background: #e2e8f0; z-index: 1; transform: translateY(-50%); }
        .progress-step { width: 35px; height: 35px; border-radius: 50%; background: #fff; border: 3px solid #e2e8f0; z-index: 2; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #94a3b8; transition: var(--transition-smooth); position: relative;}
        .progress-step.active { border-color: var(--primary-blue); background: var(--primary-blue); color: #fff; box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.2);}
        .progress-step.completed { border-color: var(--success-color); background: var(--success-color); color: #fff; }
        .step-label { position: absolute; top: 45px; font-size: 0.75rem; color: #64748b; white-space: nowrap; font-weight: 600;}
        
        .wizard-pane { display: none; animation: fadeUp 0.3s ease-out; }
        .wizard-pane.active { display: block; }

        .ad-group { margin-bottom: 24px; }
        .ad-group label { display: block; font-weight: 600; margin-bottom: 8px; color: #475569; font-size: 0.95rem;}
        .ad-input { width: 100%; padding: 14px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 1rem; transition: var(--transition-smooth); background: #f8fafc;}
        .ad-input:focus { outline: none; border-color: var(--primary-blue); background: #fff;}
        .fee-display { background: #ecfdf5; padding: 15px; text-align: center; font-size: 1.2rem; font-weight: 700; color: var(--success-color); border-radius: 8px; margin-bottom: 24px; border: 1px dashed var(--success-color); }
        .pre-reg-display { background: #eff6ff; padding: 15px; text-align: center; font-size: 1.1rem; font-weight: 700; color: var(--primary-blue-dark); border-radius: 8px; margin-bottom: 24px; border: 1px dashed var(--primary-blue); }
        
        .btn-row { display: flex; gap: 15px; margin-top: 30px;}
        .btn-full { flex: 1; padding: 16px; font-size: 1.1rem; border-radius: 8px; background: var(--primary-blue); color: white; border: none; font-weight: bold; cursor: pointer; transition: var(--transition-smooth);}
        .btn-full:hover { background: var(--primary-blue-dark); transform: translateY(-2px);}
        .btn-outline { background: transparent; color: #64748b; border: 2px solid #cbd5e1; }
        .btn-outline:hover { background: #f1f5f9; transform: translateY(-2px); }
        .btn-success { background: var(--success-color); }
        .btn-success:hover { background: #059669; }

        .payment-tabs { display: flex; gap: 10px; margin-bottom: 25px; }
        .pay-tab { flex: 1; padding: 15px; border: 2px solid #e2e8f0; border-radius: 8px; background: #f8fafc; cursor: pointer; font-weight: 600; text-align: center; color: #475569; transition: var(--transition-smooth); display: flex; flex-direction: column; align-items: center; gap: 5px;}
        .pay-tab span { font-size: 1.5rem; }
        .pay-tab.active { border-color: var(--primary-blue); background: #eff6ff; color: var(--primary-blue-dark); box-shadow: 0 4px 12px rgba(59, 130, 246, 0.1);}
        .pay-content { display: none; padding: 25px; border: 1px solid #e2e8f0; border-radius: 8px; background: #fff; animation: fadeUp 0.3s; }
        .pay-content.active { display: block; }
        .order-summary { background: #f8fafc; border-radius: 8px; padding: 15px; margin-bottom: 25px; border: 1px dashed #cbd5e1; display: flex; justify-content: space-between; font-weight: bold; color: #0f172a;}

        .invoice-details p { margin: 12px 0; display: flex; justify-content: space-between; border-bottom: 1px solid #f1f5f9; padding-bottom: 12px;}
        .invoice-details span { font-weight: 700; color: #0f172a; text-align: right; max-width: 60%;}

        @media (max-width: 900px) {
            .mobile-toggle { display: block; }
            .nav-links { display: none; position: absolute; top: 100%; left: 0; width: 100%; background: rgba(0,0,0,0.95); flex-direction: column; padding: 20px; border-bottom: 1px solid var(--border-color); gap: 15px; text-align: center; }
            .nav-links.active { display: flex; }
            .nav-actions { display: none; }
            .about-row { grid-template-columns: 1fr; }
            .contact-form { grid-template-columns: 1fr; }
            .step-label { display: none; }
        }
        @media print {
            header, footer, .btn-row, .wizard-progress { display: none !important; }
            body, #admission { background-color: white; color: black; }
            .form-box { box-shadow: none; border: none; padding: 0; margin: 0; max-width: 100%;}
        }
    </style>
</head>
<body>

    <header>
        <nav>
            <div class="nav-brand" data-target="home">
                <div class="logo-img"></div>
                <div class="logo-text">A.D.M PUBLIC SCHOOL</div>
            </div>
            <button class="mobile-toggle" aria-label="Toggle navigation">‚ò∞</button>
            <ul class="nav-links">
                <li><a href="#home" class="nav-btn active" data-target="home">Home</a></li>
                <li><a href="#about" class="nav-btn" data-target="home">About Us</a></li>
                <li><a href="#amenities" class="nav-btn" data-target="home">Amenities</a></li>
                <li><a href="#contact" class="nav-btn" data-target="home">Contact</a></li>
                <li><a href="#admission" class="nav-btn" data-target="admission" style="color: var(--accent-orange); font-weight: bold; border: 1px solid var(--accent-orange); padding: 5px 15px; border-radius: 20px;">Admission Portal</a></li>
            </ul>
            <div class="nav-actions">
                <div class="contact-phone"><span class="phone-icon">üìû</span> +91 9580624327</div>
                <button class="btn btn-primary nav-btn" data-target="admission">Admission 2026</button>
            </div>
        </nav>
    </header>

    <main>
        <section id="home" class="page-section active">
            <div class="hero-banner"></div>

            <article id="about" class="section-container">
                <h2 class="section-title">About Us</h2>
                <div class="about-grid">
                    <div class="about-row">
                        <div class="about-text">
                            <h3>Excellence in Garhwa</h3>
                            <p>We aim to foster a stimulating and secure environment where children develop socially, emotionally, academically, and physically to their full potential.</p>
                        </div>
                        <div class="about-image"></div>
                    </div>
                </div>
            </article>

            <article id="amenities" class="section-container" style="background-color: var(--bg-section);">
                <h2 class="section-title">Campus Amenities</h2>
                <div class="amenities-grid">
                    <div class="amenity-pill"><span>1</span> Smart Classrooms</div>
                    <div class="amenity-pill"><span>2</span> Secure Campus</div>
                    <div class="amenity-pill"><span>3</span> Digital Fee Portal</div>
                    <div class="amenity-pill"><span>4</span> Modern Labs</div>
                </div>
            </article>

            <article id="contact" class="section-container">
                <h2 class="section-title">Send a Message</h2>
                <form id="contactForm" class="contact-form">
                    <input type="text" id="contactName" class="minimal-input" placeholder="Full Name *" required>
                    <input type="email" id="contactEmail" class="minimal-input" placeholder="Email Address *" required>
                    <textarea id="contactMsg" class="minimal-input full-width" rows="3" placeholder="How can we help you? *" required></textarea>
                    <div class="full-width" style="text-align: center; margin-top: 10px;">
                        <button type="submit" id="btnContactSubmit" class="btn btn-primary">Send Message</button>
                    </div>
                </form>
            </article>
        </section>

        <section id="admission" class="page-section">
            <div id="wizardContainer" class="form-box">
                <h2 style="text-align: center; color: var(--primary-blue); margin-bottom: 5px;">Admission Portal 2026</h2>
                <p style="text-align: center; color: #64748b; margin-bottom: 40px;">Nursery to Class 10</p>
                
                <div class="wizard-progress">
                    <div class="progress-step active" id="indicator1">1<span class="step-label">Student Details</span></div>
                    <div class="progress-step" id="indicator2">2<span class="step-label">Contact Info</span></div>
                    <div class="progress-step" id="indicator3">3<span class="step-label">Checkout</span></div>
                </div>

                <form id="admissionForm" onsubmit="event.preventDefault();">
                    
                    <div class="wizard-pane active" id="step1">
                        <h3 style="margin-bottom: 20px; color: var(--text-dark);">Academic Information</h3>
                        <div class="ad-group">
                            <label for="studentClass">Select Class for Enrollment <span style="color:red;">*</span></label>
                            <select id="studentClass" class="ad-input" required>
                                <option value="" disabled selected>-- Choose Class --</option>
                                <option value="Nursery">Nursery</option>
                                <option value="LKG">LKG</option>
                                <option value="UKG">UKG</option>
                                <option value="Class 1">Class 1</option>
                                <option value="Class 2">Class 2</option>
                                <option value="Class 3">Class 3</option>
                                <option value="Class 4">Class 4</option>
                                <option value="Class 5">Class 5</option>
                                <option value="Class 6">Class 6</option>
                                <option value="Class 7">Class 7</option>
                                <option value="Class 8">Class 8</option>
                                <option value="Class 9">Class 9</option>
                                <option value="Class 10">Class 10 (Pre-Registration)</option>
                            </select>
                        </div>
                        <div id="dynamicFormFields" style="display: none;">
                            <div class="ad-group">
                                <label for="studentName">Student's Full Name <span style="color:red;">*</span></label>
                                <input type="text" id="studentName" class="ad-input" placeholder="As per official birth records" required>
                            </div>
                            <div class="ad-group">
                                <label for="dob">Date of Birth <span style="color:red;">*</span></label>
                                <input type="date" id="dob" class="ad-input" required>
                            </div>
                            <div class="btn-row">
                                <button type="button" class="btn-full" onclick="Wizard.next(1)">Continue to Next Step ‚Üí</button>
                            </div>
                        </div>
                    </div>

                    <div class="wizard-pane" id="step2">
                        <h3 style="margin-bottom: 20px; color: var(--text-dark);">Guardian Details</h3>
                        <div class="ad-group">
                            <label for="parentName">Parent/Guardian Name <span style="color:red;">*</span></label>
                            <input type="text" id="parentName" class="ad-input" required>
                        </div>
                        <div class="ad-group">
                            <label for="mobileNo">Primary Mobile Number <span style="color:red;">*</span></label>
                            <input type="tel" id="mobileNo" class="ad-input" pattern="[0-9]{10}" maxlength="10" placeholder="10-digit mobile number" required>
                        </div>
                        <div class="ad-group">
                            <label for="address">Full Residential Address <span style="color:red;">*</span></label>
                            <textarea id="address" class="ad-input" rows="2" required></textarea>
                        </div>
                        <div id="feeDisplayContainer"></div>
                        <div class="btn-row">
                            <button type="button" class="btn-full btn-outline" onclick="Wizard.prev(2)">‚Üê Back</button>
                            <button type="button" id="btnNextStep2" class="btn-full" onclick="Wizard.next(2)">Proceed</button>
                        </div>
                    </div>

                    <div class="wizard-pane" id="step3">
                        <h3 style="margin-bottom: 20px; color: var(--text-dark);">Secure Checkout</h3>
                        <div class="order-summary">
                            <span>Admission Fee Total:</span>
                            <span id="checkoutAmountText" style="color: var(--primary-blue); font-size: 1.2rem;">‚Çπ0</span>
                        </div>
                        <div class="payment-tabs">
                            <div class="pay-tab active" onclick="Wizard.switchPayTab('upi')"><span>üì±</span> UPI / QR</div>
                            <div class="pay-tab" onclick="Wizard.switchPayTab('card')"><span>üí≥</span> Credit/Debit Card</div>
                        </div>
                        <div id="pay-upi" class="pay-content active" style="text-align: center;">
                            <div style="display: inline-block; padding: 10px; border: 2px solid #e2e8f0; border-radius: 8px; margin-bottom: 15px;">
                                <img id="qrImage" src="" alt="UPI QR Code" style="display: block; border-radius: 4px;">
                            </div>
                            <div class="ad-group" style="text-align: left;">
                                <label for="utrInput">Enter 12-digit UTR to verify payment <span style="color:red;">*</span></label>
                                <input type="text" id="utrInput" class="ad-input" placeholder="e.g., 312345678901" pattern="[0-9]{12}">
                            </div>
                        </div>
                        <div id="pay-card" class="pay-content">
                            <div class="ad-group"><label>Card Number</label><input type="text" class="ad-input" placeholder="XXXX XXXX XXXX XXXX" maxlength="19"></div>
                            <div style="display: flex; gap: 15px;">
                                <div class="ad-group" style="flex: 1;"><label>Expiry Date</label><input type="text" class="ad-input" placeholder="MM/YY" maxlength="5"></div>
                                <div class="ad-group" style="flex: 1;"><label>CVV</label><input type="password" class="ad-input" placeholder="123" maxlength="3"></div>
                            </div>
                        </div>
                        <div class="btn-row">
                            <button type="button" class="btn-full btn-outline" onclick="Wizard.prev(3)">‚Üê Edit Details</button>
                            <button type="button" id="btnFinalSubmit" class="btn-full btn-success" onclick="Wizard.submitFinal()">Complete Admission ‚úÖ</button>
                        </div>
                    </div>
                </form>
            </div>

            <div id="invoiceContainer" class="form-box" style="display: none;">
                <div style="text-align: center; border-bottom: 2px dashed #cbd5e1; padding-bottom: 25px; margin-bottom: 25px;">
                    <div style="font-size: 3rem; margin-bottom: 10px;">‚úÖ</div>
                    <h2 id="invoiceTitle" style="color: var(--success-color); margin: 0 0 5px 0;">Admission Confirmed!</h2>
                    <h3 style="color: var(--primary-blue); margin: 0;">A.D.M Public School</h3>
                    <p style="margin: 5px 0 0 0; color: #64748b; font-size: 0.9rem;">Official E-Receipt</p>
                </div>
                <div class="invoice-details" id="receiptContent"></div>
                <div class="btn-row" style="margin-top: 30px;">
                    <button type="button" class="btn-full" onclick="window.print()">üñ®Ô∏è Print Receipt</button>
                    <button type="button" class="btn-full btn-outline" onclick="window.location.reload()">Return Home</button>
                </div>
            </div>
        </section>
    </main>

    <footer style="background-color: var(--footer-blue); padding: 40px 20px; text-align: center; color: white;">
        <h3>A.D.M Public School</h3>
        <div style="display: flex; justify-content: center; gap: 20px; margin-top: 15px; font-size: 0.9rem;">
            <span>‚úâÔ∏è rritu8786@gmail.com</span>
            <span>üìû +91 9580624327</span>
        </div>
        <p style="font-size: 0.8rem; color: #cbd5e1; margin-top: 20px;">¬© 2026. All rights reserved.</p>
    </footer>

    <div id="toast-container" aria-live="polite"></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- 1. SET UP AUTOMATED EMAILS ---
            const WEB3FORMS_ACCESS_KEY = "2d45d9fd-afe0-44fc-83f9-7962612255b4";

            // --- 2. Global State ---
            const state = {
                feeStructure: {
                    "Nursery": 1, "LKG": 3500, "UKG": 3500,
                    "Class 1": 4000, "Class 2": 4500, "Class 3": 5000, "Class 4": 5500, 
                    "Class 5": 6000, "Class 6": 7000, "Class 7": 7500, "Class 8": 8000, 
                    "Class 9": 9000
                },
                enrollmentCounts: {},
                currentFee: 0,
                selectedPayMethod: 'upi',
                isPreRegMode: false
            };

            // --- 3. UI Utilities ---
            const UI = {
                showToast: (message, type = 'success') => {
                    const container = document.getElementById('toast-container');
                    const toast = document.createElement('div');
                    toast.className = `toast ${type}`;
                    toast.innerHTML = `<span>${type === 'success' ? '‚úÖ' : '‚ö†Ô∏è'}</span> ${message}`;
                    container.appendChild(toast);
                    setTimeout(() => {
                        toast.style.animation = 'fadeOut 0.3s forwards';
                        setTimeout(() => toast.remove(), 300);
                    }, 4000);
                },
                switchPage: (targetId) => {
                    document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
                    document.querySelectorAll(`[data-target="${targetId}"]`).forEach(btn => btn.classList.add('active'));
                    document.querySelectorAll('.page-section').forEach(sec => sec.classList.remove('active'));
                    document.getElementById(targetId)?.classList.add('active');
                    document.querySelector('.nav-links').classList.remove('active');
                    window.scrollTo(0, 0);
                }
            };

            // Background Email Sender Function
            async function sendAdminEmail(subject, messageBody) {
                try {
                    await fetch("https://api.web3forms.com/submit", {
                        method: "POST",
                        headers: { "Content-Type": "application/json", Accept: "application/json" },
                        body: JSON.stringify({
                            access_key: WEB3FORMS_ACCESS_KEY,
                            subject: subject,
                            from_name: "A.D.M Website Alert",
                            message: messageBody,
                        })
                    });
                } catch (error) {
                    console.error("Failed to send background email.", error);
                }
            }

            // Nav Listeners
            document.querySelectorAll('.nav-btn, .nav-brand').forEach(el => {
                el.addEventListener('click', (e) => UI.switchPage(e.currentTarget.dataset.target));
            });
            document.querySelector('.mobile-toggle').addEventListener('click', () => {
                document.querySelector('.nav-links').classList.toggle('active');
            });

            // Contact Form Submission
            document.getElementById('contactForm').addEventListener('submit', (e) => {
                e.preventDefault();
                const name = document.getElementById('contactName').value;
                const email = document.getElementById('contactEmail').value;
                const msg = document.getElementById('contactMsg').value;
                
                // Send automated email for contact form
                sendAdminEmail(
                    `New Website Contact from ${name}`, 
                    `Name: ${name}\nEmail: ${email}\n\nMessage:\n${msg}`
                );

                UI.showToast('Message sent to administration!', 'success');
                e.target.reset();
            });

            // Dynamic Conditional Routing Based on Class
            document.getElementById('studentClass').addEventListener('change', (e) => {
                const cls = e.target.value;
                document.getElementById('dynamicFormFields').style.display = 'block';

                if (cls === 'Class 10') {
                    state.isPreRegMode = true;
                    state.currentFee = 0;
                    document.getElementById('feeDisplayContainer').innerHTML = `<div class="pre-reg-display"><strong>Class 10 Pre-Registration Mode</strong><br><span style="font-size:0.9rem; color:#64748b; font-weight:normal;">No immediate fee payment required. Your application will be reviewed.</span></div>`;
                    document.getElementById('btnNextStep2').innerText = "Submit Pre-Registration";
                    document.getElementById('indicator3').style.display = 'none'; 
                } else {
                    state.isPreRegMode = false;
                    state.currentFee = state.feeStructure[cls];
                    document.getElementById('feeDisplayContainer').innerHTML = `<div class="fee-display">Calculated Admission Fee: <strong>‚Çπ${state.currentFee}</strong></div>`;
                    document.getElementById('btnNextStep2').innerText = "Proceed to Payment Gateway";
                    document.getElementById('indicator3').style.display = 'flex'; 
                }
            });

            // --- Wizard Controller ---
            window.Wizard = {
                validateStep: (stepNum) => {
                    const inputs = document.getElementById(`step${stepNum}`).querySelectorAll('input, select, textarea');
                    let isValid = true;
                    inputs.forEach(input => {
                        if (!input.checkValidity()) {
                            input.reportValidity();
                            isValid = false;
                        }
                    });
                    return isValid;
                },

                next: (currentStep) => {
                    if (!Wizard.validateStep(currentStep)) return;
                    
                    if (currentStep === 1) {
                        document.getElementById(`step1`).classList.remove('active');
                        document.getElementById(`step2`).classList.add('active');
                        document.getElementById(`indicator1`).classList.add('completed');
                        document.getElementById(`indicator2`).classList.add('active');
                    }
                    else if (currentStep === 2) {
                        if (state.isPreRegMode) {
                            // Bypass Payment for Class 10
                            Wizard.submitPreRegistration();
                        } else {
                            // Standard Payment Route
                            const fee = state.currentFee;
                            document.getElementById('checkoutAmountText').innerText = `‚Çπ${fee}`;
                            
                            const upiString = `upi://pay?pa=9580624327@ibl&pn=A.D.M%20Public%20School&am=${fee}&cu=INR`;
                            document.getElementById('qrImage').src = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(upiString)}&margin=10`;

                            document.getElementById(`step2`).classList.remove('active');
                            document.getElementById(`step3`).classList.add('active');
                            document.getElementById(`indicator2`).classList.add('completed');
                            document.getElementById(`indicator3`).classList.add('active');
                        }
                    }
                },

                prev: (currentStep) => {
                    document.getElementById(`step${currentStep}`).classList.remove('active');
                    document.getElementById(`step${currentStep - 1}`).classList.add('active');
                    document.getElementById(`indicator${currentStep}`).classList.remove('active');
                    document.getElementById(`indicator${currentStep - 1}`).classList.remove('completed');
                },

                switchPayTab: (method) => {
                    state.selectedPayMethod = method;
                    document.querySelectorAll('.pay-tab').forEach(tab => tab.classList.remove('active'));
                    event.currentTarget.classList.add('active');
                    
                    document.querySelectorAll('.pay-content').forEach(content => content.classList.remove('active'));
                    document.getElementById(`pay-${method}`).classList.add('active');
                    
                    const utrInput = document.getElementById('utrInput');
                    if(method === 'upi') utrInput.setAttribute('required', 'true');
                    else utrInput.removeAttribute('required');
                },

                submitPreRegistration: () => {
                    const btn = document.getElementById('btnNextStep2');
                    btn.innerText = "Submitting...";
                    btn.disabled = true;

                    const adClass = document.getElementById('studentClass').value;
                    const studentName = document.getElementById('studentName').value;
                    const mobile = document.getElementById('mobileNo').value;
                    
                    state.enrollmentCounts[adClass] = (state.enrollmentCounts[adClass] || 0) + 1;
                    const rollNo = "PRE-" + state.enrollmentCounts[adClass].toString().padStart(3, '0');
                    const today = new Date().toLocaleDateString('en-IN', { year: 'numeric', month: 'long', day: 'numeric' });

                    // SEND AUTOMATED EMAIL
                    sendAdminEmail(
                        `URGENT: Class 10 Pre-Registration - ${studentName}`,
                        `A new Class 10 Pre-Registration was submitted.\n\nStudent: ${studentName}\nRef Number: ${rollNo}\nParent: ${document.getElementById('parentName').value}\nMobile: ${mobile}\nAddress: ${document.getElementById('address').value}\nDate: ${today}\n\nLog in to review their application.`
                    );

                    const receiptHTML = `
                        <p>Status: <span style="color: var(--primary-blue);">Pre-Registered (Pending Review)</span></p>
                        <p>Date: <span>${today}</span></p>
                        <p style="color: var(--primary-blue); font-size: 1.1rem; padding-top: 15px; border-top: 2px dashed #cbd5e1;">Reference No: <span>${rollNo}</span></p>
                        <p>Student Name: <span>${studentName}</span></p>
                        <p>Class: <span>Class 10</span></p>
                        <p style="border-bottom: none; margin-top: 15px;">Fee Paid: <span style="color: #64748b; font-size: 1.2rem;">‚Çπ0 (No Immediate Payment)</span></p>
                    `;
                    
                    document.getElementById('receiptContent').innerHTML = receiptHTML;
                    document.getElementById('wizardContainer').style.display = 'none';
                    document.getElementById('invoiceContainer').style.display = 'block';
                    document.getElementById('invoiceTitle').innerText = "Pre-Registration Submitted!";
                    
                    UI.showToast('Pre-registration successfully submitted!', 'success');
                },

                submitFinal: () => {
                    if (state.selectedPayMethod === 'upi') {
                        const utr = document.getElementById('utrInput');
                        if (!utr.value || utr.value.length < 8) {
                            utr.reportValidity();
                            UI.showToast('Please enter a valid UTR number.', 'error');
                            return;
                        }
                    } else {
                        UI.showToast('Processing secure card payment...', 'success');
                    }

                    const btn = document.getElementById('btnFinalSubmit');
                    btn.innerText = "Processing...";
                    btn.disabled = true;

                    const adClass = document.getElementById('studentClass').value;
                    const studentName = document.getElementById('studentName').value;
                    const mobile = document.getElementById('mobileNo').value;

                    state.enrollmentCounts[adClass] = (state.enrollmentCounts[adClass] || 0) + 1;
                    const rollNo = state.enrollmentCounts[adClass].toString().padStart(2, '0');
                    const today = new Date().toLocaleDateString('en-IN', { year: 'numeric', month: 'long', day: 'numeric' });
                    const txnId = state.selectedPayMethod === 'upi' ? document.getElementById('utrInput').value : 'CARD' + Math.floor(Math.random() * 900000000);

                    // SEND AUTOMATED EMAIL
                    sendAdminEmail(
                        `SUCCESS: New Admission - ${studentName} (${adClass})`,
                        `A new student has successfully completed the admission payment.\n\nStudent: ${studentName}\nClass: ${adClass}\nRoll Number: ${rollNo}\nParent: ${document.getElementById('parentName').value}\nMobile: ${mobile}\nAddress: ${document.getElementById('address').value}\n\n--- Payment Details ---\nAmount Paid: ‚Çπ${state.currentFee}\nTransaction ID: ${txnId}\nDate: ${today}`
                    );

                    const receiptHTML = `
                        <p>Transaction Ref: <span>${txnId}</span></p>
                        <p>Date: <span>${today}</span></p>
                        <p>Method: <span>${state.selectedPayMethod.toUpperCase()}</span></p>
                        <p style="color: var(--primary-blue); font-size: 1.1rem; padding-top: 15px; border-top: 2px dashed #cbd5e1;">Roll Number: <span>${rollNo}</span></p>
                        <p>Student Name: <span>${studentName}</span></p>
                        <p>Admitted To: <span>${adClass}</span></p>
                        <p style="border-bottom: none; margin-top: 15px;">Total Paid: <span style="color: var(--success-color); font-size: 1.2rem;">‚Çπ${state.currentFee}</span></p>
                    `;
                    
                    document.getElementById('receiptContent').innerHTML = receiptHTML;
                    document.getElementById('wizardContainer').style.display = 'none';
                    document.getElementById('invoiceContainer').style.display = 'block';
                    document.getElementById('invoiceTitle').innerText = "Admission Confirmed!";
                    
                    UI.showToast('Admission successfully completed!', 'success');
                }
            };
        });
    </script>
</body>
</html>